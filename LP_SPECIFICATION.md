# TAXI Navigator - ランディングページ用 機能仕様書

## アプリ概要

**TAXI Navigator**は、タクシー運転手向けの営業売上管理アプリケーションです。売上の記録、分析、ランキング機能を提供し、運転手の営業効率化と目標達成をサポートします。

## 主要機能一覧

### 1. 入力モード（2つのモードを選択可能）

#### 1.1 簡易入力モード
- **概要**: 1日の営業終了後に、まとめてデータを入力するシンプルなモード
- **入力項目**:
  - 売上金額（数字入力、カンマ区切り対応）
  - 営業回数（乗車回数）
  - 営業時間（時間と分）
  - 勤務日（カレンダーから選択）
  - 備考（メモ）
- **特徴**:
  - 入力が簡単でスピーディー
  - 数字以外の入力をブロック
  - 同じ日のデータは自動的に上書き保存
- **制限事項**:
  - 乗降地データの記録は不可
  - 詳細な分析機能の一部が制限される

#### 1.2 詳細入力モード
- **概要**: 1乗車ごとに詳細な情報を記録するモード
- **入力項目**:
  - 売上金額
  - 高速料金
  - 支払方法（現金、クレジットカード、電子マネー、QR決済など、カスタマイズ可能）
  - 乗車種別（流し、配車、迎車、その他、カスタマイズ可能）
  - 乗降地（出発地・到着地）
  - 乗客情報（男性・女性の人数）
  - タイムスタンプ
  - 備考
- **特徴**:
  - 全機能が利用可能
  - 詳細な売上分析が可能
  - 乗降地の傾向分析が可能
  - 決済方法別の統計が可能
- **その他機能**:
  - 営業開始・終了の記録
  - 休憩時間の記録
  - 走行距離の記録（開始時・終了時のオドメーター）

### 2. ダッシュボード機能

#### 2.1 簡易モード ダッシュボード
- **表示内容**:
  - **売上状況**:
    - 現在の月間売上（営業期間ベース）
    - 月間目標
    - 1日平均売上
    - 達成率（%）
  - **目標進捗**:
    - 進捗バー（視覚的な達成率表示）
    - 目標まで残り金額
    - 残り出勤日数
    - 必要売上（1日あたり）- **リアルタイム計算**
  - **出勤予定カレンダー**:
    - 営業期間ベースの5週間カレンダー（締め日設定に基づく）
    - データ入力済みの日をハイライト表示
    - 過去日はグレーアウト（表示はされるが選択不可）
    - 月のナビゲーション（前/次の営業期間に移動）
- **リアルタイム変動機能**:
  - 売上を入力すると、必要売上（1日あたり）が自動再計算
  - 残り日数が減ると、必要売上も自動調整
  - 目標を変更すると、すべての指標がリアルタイム更新
- **編集機能**:
  - 月間目標の編集
  - 残り出勤日数の編集
  - 締め日の変更（設定画面から）
  - 出勤予定日のカレンダー編集

#### 2.2 詳細モード ダッシュボード
- **表示内容**:
  - **現在の営業状況**:
    - 営業中/休憩中/営業終了のステータス表示
    - 現在の売上合計（リアルタイム）
    - 税抜合計
    - 基準値との差（プラス/マイナス表示）
  - **今日の目標**:
    - 今日の目標金額
    - 達成率（%）
    - 進捗バー
    - 目標まで残り金額 - **リアルタイム計算**
  - **KPIカード**:
    - 時間あたりの売上
    - 乗車回数
    - 月間必要売上（1日あたり）- **リアルタイム計算**
    - 目標まで残り - **リアルタイム計算**
  - **アクションボタン**:
    - 営業開始/終了
    - 休憩開始/終了
    - 乗車記録追加
- **リアルタイム機能**:
  - 営業中に売上を追加すると、すべての指標が即座に更新
  - 時間経過に応じて時間あたりの売上が自動計算

### 3. ランキング機能

#### 3.1 簡易モード ランキング
- **月間ランキング**:
  - 全ユーザーの月間売上をランク付け
  - 自分の順位をハイライト表示
  - 目標達成率の表示
  - Top 20まで表示
- **日別ランキング**:
  - 選択した日付の売上ランキング
  - 日付選択機能（カレンダー）
  - 自分の順位をハイライト表示

#### 3.2 詳細モード ランキング
- **歴代最高記録**:
  - 全ユーザーの過去最高売上記録
  - Top 20まで表示
  - 簡易モードのレコードは除外
- **月間ランキング**:
  - 現在の営業期間の月間売上ランキング
- **日別ランキング**:
  - 選択した日付の売上ランキング
  - 日付選択機能

### 4. カレンダー表示機能

#### 4.1 営業期間ベースカレンダー（簡易モード/詳細モード設定画面）
- **特徴**:
  - 締め日設定（shimebiDay）に基づいて営業期間を表示
  - 例: 20日締めの場合、2026年1月度は2025/12/21～2026/01/20
  - 5週間（35日）のカレンダー表示
  - データ入力済みの日をハイライト
  - 過去日は表示されるが選択不可（グレーアウト）
- **ナビゲーション**:
  - 前/次の営業期間に移動可能
  - 営業期間の終了月を表示（例: "2026年1月"）

#### 4.2 通常月ベースカレンダー（?calページ）
- **特徴**:
  - 標準的な月ベースのカレンダー表示
  - 日付ごとの売上合計を表示
  - 祝日の表示
  - 月間売上の合計を表示

### 5. 営業履歴機能

#### 5.1 簡易モード 履歴
- **表示内容**:
  - 営業期間ごとにグループ化された履歴
  - 日別の売上合計
  - 営業回数
  - 営業時間
  - 備考
- **月間サマリー**:
  - 営業期間内の合計売上
  - 合計営業回数
  - 合計営業時間
  - **1日平均売上**（データがある日数で割る）
  - 営業日数
- **ナビゲーション**:
  - 前/次の営業期間に移動
  - 営業期間の終了月を表示

#### 5.2 詳細モード 履歴
- **表示内容**:
  - 月別ダッシュボード
  - 日別の詳細記録
  - 決済方法別の内訳
  - 乗車種別の内訳
  - 乗降地の記録
- **機能**:
  - 記録の編集・削除
  - 日別の詳細表示
  - 他のユーザーの履歴閲覧（権限がある場合）

### 6. 統計・分析機能

#### 6.1 分析画面
- **表示内容**:
  - 月間統計
  - 決済方法別の比率（円グラフ/リスト）
  - 乗車種別の比率
  - 乗客データ（男女比）
  - 平均単価
  - 時間帯別の傾向（時間あたりの売上）
- **期間選択**:
  - 月単位で期間を選択
  - 営業期間ベースでの集計

#### 6.2 アナリティクス画面
- **詳細分析**:
  - 乗降地の傾向分析
  - 時間帯別の売上分析
  - 曜日別の傾向
  - 月間推移グラフ

### 7. 目標管理機能

- **月間目標設定**:
  - 目標金額の設定
  - 進捗の可視化
  - 達成率の表示
  - 必要売上（1日あたり）の自動計算
- **日別目標設定**:
  - デフォルトの日別目標設定
  - 営業日の目標設定
- **目標編集**:
  - リアルタイムでの目標変更
  - 変更後の指標の自動再計算

### 8. 設定機能

- **基本設定**:
  - ユーザー名の変更
  - 入力モードの変更（簡易/詳細）
  - 締め日の設定（0～28日、0は月末）
  - 営業開始時刻の設定
- **目標設定**:
  - 月間目標の設定
  - デフォルト日別目標の設定
  - 残り営業日数の設定
- **出勤予定設定**:
  - カレンダーから出勤予定日を選択
  - 営業期間ベースでの管理
- **決済方法設定**:
  - 利用する決済方法の選択
  - 決済方法のラベルカスタマイズ
  - 表示順序の変更
- **乗車種別設定**:
  - 利用する乗車種別の選択
  - 乗車種別のラベルカスタマイズ
- **公開設定**:
  - ランキングへの参加/非参加
  - 公開範囲の設定（全体公開/限定公開）
  - フォロー機能（他のユーザーをフォロー）
- **データ管理**:
  - CSVデータのインポート（管理者のみ）
  - データのエクスポート

### 9. データエクスポート機能

- **CSVエクスポート**:
  - 営業履歴をCSV形式でダウンロード
  - Excelなどで開いて分析可能
  - 期間を指定してエクスポート可能

### 10. 管理者機能

- **ユーザー管理**:
  - 全ユーザーの一覧表示
  - ユーザーの承認/非承認
  - ユーザーの削除（関連データも削除）
  - ユーザーの検索
- **CSVインポート**:
  - Excelファイルから売上データを一括インポート
  - ユーザーを指定してインポート可能
  - 重複データの処理（上書き/スキップ）を選択可能
  - インポート進捗の表示
- **通知機能**:
  - 新規ユーザーが承認待ち状態になったとき、管理者にメール通知（Firebase Cloud Functions + SendGrid）

### 11. 認証・セキュリティ機能

- **Google認証**:
  - Googleアカウントで簡単ログイン
  - 初回ログイン時の名前入力
  - モード選択（簡易/詳細）
- **権限管理**:
  - 管理者権限と一般ユーザー権限
  - Firestoreセキュリティルールによるデータ保護
  - ユーザーごとのデータ分離

### 12. データ同期機能

- **リアルタイム同期**:
  - Firestoreのリアルタイム更新
  - 複数デバイス間での自動同期
  - オフライン対応（後で同期）
- **データバックアップ**:
  - Firebase Cloud上に自動保存
  - データの自動バックアップ

### 13. UI/UX特徴

- **レスポンシブデザイン**:
  - スマートフォン対応
  - タブレット対応
  - PC対応
- **ダークテーマ**:
  - 目に優しいダークカラースキーム
  - アクセントカラー: アンバー/オレンジ（#f59e0b, #f97316）
  - 詳細モード: ブルー（#3b82f6）
- **アニメーション**:
  - スムーズな画面遷移
  - ローディングアニメーション
  - ホバーエフェクト
- **アクセシビリティ**:
  - 大きなタッチターゲット
  - 明確なコントラスト
  - 読みやすいフォントサイズ

### 14. キャラクター・ブランディング

- **マスコットキャラクター**:
  - ナビ（Navi）という名前のキャラクター
  - アニメ風のデザイン
  - アプリの各画面に表示
- **ブランドカラー**:
  - メイン: アンバー/オレンジ（#f59e0b）
  - サブ: ブルー（#3b82f6）
  - 背景: ダーク（#0A0E14, #1A222C）

## 技術仕様

- **フロントエンド**: React + TypeScript + Vite
- **バックエンド**: Firebase (Firestore, Authentication, Hosting, Cloud Functions)
- **スタイリング**: Tailwind CSS
- **状態管理**: React Hooks (useState, useEffect, useMemo, useCallback)
- **データベース**: Firestore (NoSQL)
- **認証**: Firebase Authentication (Google Sign-In)
- **ホスティング**: Firebase Hosting
- **サーバーレス**: Firebase Cloud Functions (Node.js 20)

## 主要な数値・指標

### リアルタイム計算される指標

1. **必要売上（1日あたり）**
   - 計算式: (目標 - 現在の売上) / 残り営業日数
   - 変動タイミング: 売上入力時、日数経過時、目標変更時

2. **達成率**
   - 計算式: (現在の売上 / 目標) × 100
   - 変動タイミング: 売上入力時、目標変更時

3. **目標まで残り**
   - 計算式: 目標 - 現在の売上
   - 変動タイミング: 売上入力時、目標変更時

4. **1日平均**
   - 計算式: 期間内の合計売上 / データがある日数
   - 変動タイミング: 売上入力時

5. **時間あたりの売上**（詳細モード）
   - 計算式: 現在の売上 / 営業時間
   - 変動タイミング: 売上入力時、時間経過時

## ユーザーフロー

### 初回ログイン
1. Googleアカウントでログイン
2. 名前を入力
3. モード選択（簡易/詳細）
4. ダッシュボードへ遷移

### 通常の利用フロー（簡易モード）
1. ダッシュボードで現在の売上・進捗を確認
2. 「売上入力」ボタンから入力画面へ
3. 売上、営業回数、時間などを入力
4. 保存するとダッシュボードの指標が自動更新
5. 履歴タブで過去のデータを確認
6. ランキングタブで他の運転手と競い合う

### 通常の利用フロー（詳細モード）
1. ダッシュボードで営業開始
2. 乗車ごとに「乗車記録」ボタンで詳細を入力
3. リアルタイムで売上・指標が更新
4. 休憩・営業終了の記録
5. 分析タブで詳細な統計を確認
6. ランキングタブで競い合う

## LPで強調すべきポイント

1. **2つの入力モード** - ユーザーのスタイルに合わせて選択可能
2. **リアルタイム変動** - 売上入力と同時に必要な売上が自動計算される
3. **目標管理** - 月間目標を設定し、進捗を可視化
4. **ランキング機能** - 他の運転手と競い合える
5. **簡単操作** - 直感的なUIで誰でも使いやすい
6. **スマートフォン対応** - 外出先でもすぐに入力可能
7. **データ安全** - Firebaseの安全なクラウドに保存
8. **無料** - Googleアカウントがあればすぐに始められる
9. **詳細な分析** - 乗降地、決済方法、時間帯など様々な角度から分析可能
10. **カレンダー管理** - 営業スケジュールを視覚的に管理

## 画面イメージの推奨配置

1. **ヒーローセクション**: キャラクター画像 + キャッチコピー
2. **入力モード紹介**: 簡易/詳細の2カラム比較
3. **ダッシュボードモック**: 実際の画面イメージ（数値入り）
4. **ランキングモック**: ランキング画面のイメージ
5. **リアルタイム変動の説明**: 必要売上が変動する仕組みの説明
6. **機能一覧**: 各機能のカード表示
7. **CTA**: 無料で始めるボタン

## 注意事項

- 数値は実際の画面イメージと同じフォーマットで表示（カンマ区切り、¥マーク）
- ダークテーマを維持
- キャラクター画像を効果的に配置
- スマートフォンでの表示を最優先に設計
- 実際のアプリのUI/UXを忠実に再現
